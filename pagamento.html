<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Roleta Promocional</title>
  <style>
    body {
      background: #111;
      color: white;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      text-align: center;
    }

    h1 {
      padding: 20px;
      color: red;
    }

    #roleta-container {
      position: relative;
      width: 300px;
      height: 300px;
      margin: 20px auto;
    }

    #ponteiro {
      width: 0;
      height: 0;
      border-left: 20px solid transparent;
      border-right: 20px solid transparent;
      border-bottom: 30px solid black;
      position: absolute;
      top: -30px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
    }

    #roleta {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 6px solid red;
      position: relative;
      transition: transform 4s cubic-bezier(0.33, 1, 0.68, 1);
    }

    .segmento {
      position: absolute;
      width: 50%;
      height: 50%;
      top: 50%;
      left: 50%;
      transform-origin: 0% 0%;
      text-align: center;
      line-height: 2;
      font-size: 16px;
      font-weight: bold;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      text-shadow: 1px 1px 2px black;
    }

    .destaque {
      animation: destaque 1s infinite;
    }

    @keyframes destaque {
      0%, 100% {
        transform: scale(1.2);
      }
      50% {
        transform: scale(1.0);
      }
    }

    button {
      padding: 15px 30px;
      font-size: 18px;
      margin-top: 20px;
      background: red;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-weight: bold;
    }

    #mensagem {
      margin-top: 20px;
      font-size: 18px;
      color: #00ff00;
      display: none;
    }
  </style>
</head>
<body>

  <h1>ðŸŽ¯ Gire a roleta e ganhe um desconto!</h1>

  <div id="roleta-container">
    <div id="ponteiro"></div>
    <div id="roleta"></div>
  </div>

  <button onclick="girar()">ðŸŽ² Girar</button>

  <div id="mensagem"></div>

  <script>
    const valores = ['1000 MT', '897 MT', '800 MT', '650 MT', '500 MT', '197 MT', 'Repetir'];
    const cores = ['#f44336', '#9c27b0', '#3f51b5', '#2196f3', '#009688', '#4caf50', '#ff9800'];

    const roleta = document.getElementById('roleta');
    const mensagem = document.getElementById('mensagem');

    let anguloAtual = 0;
    let resultadoFinal = '';

    function desenharRoleta() {
      roleta.innerHTML = '';
      const total = valores.length;
      const angulo = 360 / total;

      for (let i = 0; i < total; i++) {
        const div = document.createElement('div');
        div.className = 'segmento';
        div.style.transform = `rotate(${i * angulo}deg) skewY(-${90 - angulo}deg)`;
        div.style.backgroundColor = cores[i % cores.length];
        div.innerHTML = `<div style="transform: skewY(${90 - angulo}deg) rotate(${angulo / 2}deg); width: 100px;">${valores[i]}</div>`;
        roleta.appendChild(div);
      }
    }

    function girar() {
      const total = valores.length;
      let sorteado;

      // LÃ³gica para controlar a aleatoriedade
      const ultima = localStorage.getItem('resultadoRoleta');
      if (!ultima || ultima === 'Repetir') {
        const opcoes = ['Repetir', '197 MT'];
        sorteado = opcoes[Math.random() < 0.5 ? 0 : 1];
      } else {
        sorteado = ultima; // MantÃ©m o resultado anterior
      }

      const index = valores.indexOf(sorteado);
      const anguloSegmento = 360 / total;
      const rotacaoBase = 360 * 5; // giros completos
      const destino = 360 - (index * anguloSegmento) - anguloSegmento / 2;

      anguloAtual += rotacaoBase + destino;

      roleta.style.transition = 'transform 4s ease-out';
      roleta.style.transform = `rotate(${anguloAtual}deg)`;

      setTimeout(() => {
        localStorage.setItem('resultadoRoleta', sorteado);
        destacarSegmento(index);
        if (sorteado === '197 MT') {
          mensagem.innerText = 'ðŸŽ‰ ParabÃ©ns! VocÃª conseguiu a oferta de 197 MT. VÃ¡lida por 1 hora!';
          mensagem.style.display = 'block';
        } else if (sorteado === 'Repetir') {
          mensagem.innerText = 'ðŸ˜… Quase! Clique em girar para tentar novamente.';
          mensagem.style.display = 'block';
        } else {
          mensagem.innerText = `ðŸ˜Ž VocÃª ganhou a oferta de ${sorteado}!`;
          mensagem.style.display = 'block';
        }
      }, 4000);
    }

    function destacarSegmento(index) {
      const segmentos = document.querySelectorAll('.segmento');
      segmentos.forEach(s => s.classList.remove('destaque'));
      if (segmentos[index]) {
        segmentos[index].classList.add('destaque');
      }
    }

    desenharRoleta();
  </script>

</body>
</html>
